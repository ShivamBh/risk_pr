{% extends "base.html" %}
{% load static %}

{% block title %}{{ country.name }}- Detail {% endblock %}


{% block header %}
	<nav class="side-nav">
		<div class="nav-menu">
			<div class="nav-items">
				<a href="{% url "report_list" %}" class="nav-links">Reports</a>
			</div>
			<div class="nav-items">
				<a href="{% url "home" %}" class="nav-links">Countries</a>
			</div>
		</div>
	</nav>

{% endblock %}


{% block content %}

	<main class="container">
		
		<section class="header-wrapper">
			<div class="section-header">
				<h1>Dashboard</h1>
			</div>
			<div class="search">
				<form action="{% url 'report_search' %}" id="search-form" method="get" accept-charset="utf-8" class="search-form">
					<button class="search-button" type="submit">
						<i class="fa fa-search" aria-hidden="true"></i>
					</button>
					<input type="text" class="search-field" id="searchbox" name="q" placeholder="Search">
					<div class="search-dropdown">

						<p>Advanced Search</p>
						<div class="dropdown-content">
							<p>Country</p>
							<input type="text" class="search-field" id="searchbox2" name="l" placeholder="Country">
							<p>Type of Report</p>
							<select name="t" id="search-type">
								<option value="T">Travel</option>
								<option value="C">Country</option>
								<option value="TC">Both</option>
							</select>
							<p>From Date<br class="form-break"> <input type="text" id="datepicker_from" name="fd" placeholder="From Date"></p>
							<p>To Date<br class="form-break"><input type="text" id="datepicker_to" name="td" placeholder="To Date"></p>
					
					</div>
					</div>
				</form>
			</div>
			<div class="user-settings">
				<a href="/logout/" class="profile-link">
				    <i class="fa fa-sign-out fa-2x icons" aria-hidden="true"></i>
				    
				</a>
				<a href="/profile/" class="profile-link">
					<i class="fa fa-user-circle fa-2x icons" aria-hidden="true"></i>
				</a>
			</div>

			
		</section>

		
		<div class="c-tabs no-js" id="tabs">
			<div class="c-tabs-nav">
				<a href="#" class="c-tabs-nav__link is-active">Full Report</a>
				<a href="#" class="c-tabs-nav__link" id="mapviewBtn">Map View</a>
			</div>

			<div class="c-tab is-active">
				<div class="c-tab__content">
					<section class="content-wrapper">

						<div class="main-content">

							<div class="country-detail-wrapper">

								<div class="ratings">
									<div class="country-ratings">
										<div class="country-rating-item">
											<div class="rating-img political-rating">
												<img src="{% static 'img/red_thermo.svg' %}" alt="Political Rating">
												<span class="rating-span">{{ country.political_rating }}</span>
											</div>
											<div class="rating-text">
												<p>Political</p>
											</div>
										</div>
										<div class="country-rating-item">
											<div class="rating-img terror-rating">
												<img src="{% static 'img/yellow_thermo.svg' %}" alt="Terror Rating">
												<span class="rating-span">{{ country.terror_rating }}</span>
											</div>
											<div class="rating-text">
												<p>Terror</p>
											</div>
										</div>
										<div class="country-rating-item">
											<div class="rating-img security-rating">
												<img src="{% static 'img/orange_thermo.svg' %}" alt="Security Rating">
												<span class="rating-span">{{ country.security_rating }}</span>
											</div>
											<div class="rating-text">
												<p>Security</p>
											</div>
										</div>
										<div class="country-rating-item">
											<div class="rating-img travel-rating">
												<img src="{% static 'img/green_thermo.svg' %}" alt="Travel Rating">
												<span class="rating-span">{{ country.travel_rating }}</span>
											</div>
											<div class="rating-text">
												<p>Travel</p>
											</div>
										</div>
									</div>
									

								
								</div>
								<div class="country-bg">
									<div class="country-bg-header">
										<h2>Country Background :</h2>
									</div>
									<div class="country-bg-text">
										<p>{{ country.risk_bg|safe }}</p>
									</div>
								</div>
								
								
							</div>
						</div>

					</section>
				</div>
			</div>
			<div class="c-tab">
				<div class="c-tab__content">
					<section class="map-view" id="mapview">
						<div class="maps-wrapper">
							
							<div class="country-map-area">
								<div id="country-maps"></div>
							</div>
							{% if rel_reps %}
							<div class="rel-reps">
								{% for report in rel_reps %}
									<span class="rel">{{ report.latitude }} {{ report.longitude }}</span>
								{% endfor %}
							</div>
							{% endif %}
						</div>
					</section>
				</div>
			</div>
		</div>
	</main>


	<!-- <script>

		function countryMap() {

			function getCoordinates(latLngList) {
				var i = 0;
				co_list = latLngList
				var arr = []
				
				for(i = 0; i < latLngList.length; i++) {
					var co_arr = [];
					var co_data = {};
					for(var j = 0; j < 1 ; j++) {
						co_data = {
							lat: Number(latLngList[i].innerHTML.split(" ")[j]),
							lng: Number(latLngList[i].innerHTML.split(" ")[j+1])
						};
					}
					arr.push(co_data);
				}

				return arr;

			}
			

			var latlng = document.querySelectorAll(".rel");
			var x = Number(latlng[1].innerHTML.split(" ")[0]);

			locList = getCoordinates(latlng);
			// console.log(locList[1].lat);

			var loc = locList[0];
			var mapOpts = {
				zoom: 3,
				center: loc,
				mapTypeId: google.maps.MapTypeId.ROADMAP
			};

			var map = new google.maps.Map(document.getElementById("country-maps"), mapOpts);
			var marker = new google.maps.Marker({position:loc});
			 marker.setMap(map);
			

			for( var i = 0; i < locList.length; i++ ) {
				var position = new google.maps.LatLng(locList[i].lat, locList[i].lng);
				var marker = new google.maps.Marker({
					position: position,
					map: map
				});
				marker.setMap(map);
			}

			google.maps.event.addDomListener(window, 'load', countryMap);

		google.maps.event.addDomListener(window, 'resize', function() {
		    var center = map.getCenter();
		    google.maps.event.trigger(map, 'resize');
		    map.setCenter(center);
		});

		}

		





	</script>

	<!-- MAPS API -->
         <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBMySJy-jCub2jfs6z-cX5c6k55Ks3yRC4&callback=countryMap"
  type="text/javascript"></script> -->

	
{% endblock %}


